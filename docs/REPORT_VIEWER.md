# レポートビューア操作ガイド

## 概要

アプリ内でレポートを1ページずつ表示する機能です。3.5インチタッチモニタ（320×480）で見やすいように、各グラフを1ページずつ表示します。

## 使用方法

### レポートの生成と表示

1. **メインメニュー** → **データ確認**
2. ログファイルを選択
3. **レポート**ボタンをタッチ
4. レポートが生成され、自動的にビューアが起動します

### ページ送り

- **<前**ボタン: 前のページに戻る
- **次>**ボタン: 次のページに進む
- **キーボード操作**: 
  - `A`キー: 前のページ
  - `D`キー: 次のページ

### 戻る

- **戻る**ボタン: データ確認画面に戻る

## レポートの構成

レポートは以下の順序で表示されます：

1. **情報ページ**: セッション情報（参加者、タスク、ブロック数など）
2. **統計ページ**: サマリ統計（平均リスク、まばたき回数など）
3. **時系列グラフ**: リスク、EAR、視線の時系列変化
4. **分布ヒストグラム**: リスク、EAR、視線の分布
5. **視線散布図**: 視線のX-Y座標の散布図（オプション）
6. **視線ヒートマップ**: 視線の密度分布（オプション）

## レポートファイル

### 保存場所

- **HTMLファイル**: `reports/session_YYYYMMDD_HHMMSS.html`
- **画像ファイル**: `reports/session_YYYYMMDD_HHMMSS_p0.png`, `_p1.png`, ...
- **メタデータ**: `reports/session_YYYYMMDD_HHMMSS_meta.json`

### メタデータ形式

```json
{
  "title": "セッション名",
  "meta": {
    "session": "セッションID",
    "participant": "参加者ID",
    "task": "タスク名",
    ...
  },
  "pages": [
    {
      "type": "meta",
      "title": "情報",
      "data": {...}
    },
    {
      "type": "image",
      "title": "時系列グラフ",
      "path": "session_20240115_143022_p0.png"
    },
    ...
  ]
}
```

## トラブルシューティング

### レポートが表示されない

1. **レポートが生成されているか確認**
   - データ確認画面で「レポート」ボタンをタッチ
   - エラーメッセージを確認

2. **メタデータファイルの確認**
   - `reports/`ディレクトリに`*_meta.json`ファイルが存在するか確認

3. **画像ファイルの確認**
   - `reports/`ディレクトリに`*_p*.png`ファイルが存在するか確認

### 画像が表示されない

1. **画像ファイルのパスを確認**
   - メタデータファイル内の`path`が正しいか確認
   - 画像ファイルが実際に存在するか確認

2. **権限の確認**
   - 画像ファイルの読み込み権限を確認

### ページ送りが動作しない

1. **ボタンの位置を確認**
   - 画面下部の「<前」「次>」ボタンをタッチ
   - キーボードの`A`/`D`キーを試す

## 手動でレポートを生成する場合

コマンドラインからレポートを生成する場合：

```bash
# 画像も保存する場合
python scripts/report.py --log logs/session_20240115_143022.csv \
  --out reports/session_20240115_143022.html \
  --save-images --image-dir reports
```

## 参考

- [GUI操作ガイド](GUI_GUIDE.md)
- [レポート作成ガイド](REPORT_GUIDE.md)

