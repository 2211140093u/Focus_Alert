# 仮想キーボード操作ガイド

## 概要

3.5インチタッチモニタ（320×480）向けに最適化された仮想キーボードです。メモ入力時に使用します。

## 起動方法

1. **メインメニュー** → **データ確認**
2. ログファイルを選択
3. **メモ編集**ボタンをタッチ

## キーボードレイアウト

### 英数字モード（デフォルト）

```
1 2 3 4 5 6 7 8 9 0
q w e r t y u i o p
a s d f g h j k l
z x c v b n m
```

### 記号モード

```
! @ # $ % ^ & * ( )
- _ = + [ ] { } \ |
; : " ' , . ? /
~ ` < >
```

### かなモード

```
あ い う え お
か き く け こ
さ し す せ そ
た ち つ て と
な に ぬ ね の
は ひ ふ へ ほ
ま み む め も
や （ ゆ ） よ
ら り る れ ろ
わ を ん ー 、
```

## 機能キー

### スペースキー
- **位置**: 中央下部
- **機能**: スペースを入力

### 削除キー（DEL）
- **位置**: スペースキーの右
- **機能**: カーソル位置の1文字を削除

### シフトキー（SHIFT）
- **位置**: スペースキーの左
- **機能**: 
  - 英数字モードで大文字入力
  - タッチするとON/OFFが切り替わる
  - 1文字入力後、自動的にOFFになる

### モード切替キー
- **位置**: 左端
- **表示**: 
  - "記号"（英数字モード時）
  - "かな"（記号モード時）
  - "ABC"（かなモード時）
- **機能**: 英数字モード → 記号モード → かなモード → 英数字モードの順に切り替え

### カーソル移動キー（左右矢印）
- **位置**: モード切替キーの右
- **表示**: "<"（左矢印）、">"（右矢印）
- **機能**: カーソル位置を左右に移動

### 確定ボタン
- **位置**: 右端
- **表示**: "確定"
- **機能**: 入力したメモを保存して編集画面を終了

### 取消ボタン
- **位置**: 確定ボタンの左
- **表示**: "取消"
- **機能**: 編集をキャンセルして元のメモに戻す

## 操作方法

### 文字入力

1. キーをタッチして文字を入力
2. 入力した文字は画面上部のテキストエリアに表示される
3. カーソル位置に文字が挿入される

### 大文字入力

1. **SHIFT**キーをタッチ（ON状態になる）
2. 文字キーをタッチ（大文字が入力される）
3. 自動的にSHIFTがOFFになる

### 記号入力

1. **モード切替**キーをタッチ（"記号"表示）
2. 記号キーをタッチ
3. 英数字に戻す場合は、再度モード切替キーをタッチ（"かな" → "ABC"）

### かな入力

1. **モード切替**キーをタッチ（"かな"表示）
2. かなキーをタッチして直接入力
3. 英数字に戻す場合は、再度モード切替キーをタッチ（"ABC"表示）

### カーソル移動

1. **<**キー（左矢印）をタッチ: カーソルを左に移動
2. **>**キー（右矢印）をタッチ: カーソルを右に移動
3. カーソル位置に文字を挿入・削除できる

### 文字削除

1. **DEL**キーをタッチ
2. カーソル位置の1文字が削除される

### メモの保存

1. 入力が完了したら**確定**ボタンをタッチ
2. メモがCSVファイルに保存される
3. データ確認画面に戻る

### 編集のキャンセル

1. **取消**ボタンをタッチ
2. 入力内容が破棄され、元のメモに戻る
3. データ確認画面に戻る

## テキスト表示

- 入力中のテキストは画面上部のテキストエリアに表示されます
- 長いテキストは自動的に折り返されます（最大2行表示）
- カーソル位置が黄色の線で表示されます

## メモの保存形式

メモはCSVファイルにイベントとして記録されます：

- **行タイプ**: `event`
- **イベントタイプ**: `note`
- **情報**: 入力したメモテキスト

複数のメモを保存した場合、すべてが記録されます。データ確認画面では最新のメモが表示されます。

## トラブルシューティング

### キーが反応しない

- タッチ位置を確認（キーの中央をタッチ）
- マウスでクリックして動作確認

### 文字が入力されない

- キーボードモードを確認（英数字/記号）
- シフトキーの状態を確認

### メモが保存されない

- 確定ボタンをタッチしたか確認
- ファイルの書き込み権限を確認
- エラーメッセージを確認

### カーソルが見えない

- テキストエリアの範囲内にカーソルがあるか確認
- 長いテキストの場合、カーソルが画面外になる可能性があります

## 実装済み機能

- ✅ カーソル位置の移動機能（左右矢印キー）
- ✅ 日本語入力（かな直接入力）
- ✅ カーソルの点滅表示
- ✅ 正確なカーソル位置計算（英数字・かな対応）

## 今後の改善予定

- [ ] ローマ字→かな変換（英数字モードでの日本語入力）
- [ ] テキストの選択・コピー機能
- [ ] 数字専用キーボード
- [ ] よく使う単語の辞書機能
- [ ] カタカナ入力モード

## 参考

- [GUI操作ガイド](GUI_GUIDE.md)
- [データ確認画面の使い方](GUI_GUIDE.md#データ確認画面の操作)

